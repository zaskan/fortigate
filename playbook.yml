---
- hosts: ip-172-31-20-205.eu-west-1.compute.internal
  collections:
   - fortinet.fortios
  connection: httpapi
  gather_facts: no
  vars:
   vdom: "root"
   ansible_httpapi_use_ssl: yes
   ansible_httpapi_validate_certs: no
   ansible_httpapi_port: 443
  tasks:
  - name: fortios_firewall_internet_service
    fortinet.fortios.fortios_firewall_internet_service:
      vdom: root
      state: present
      firewall_internet_service:
        database: isdb
        direction: dst
        extra_ip_range_number: 0
        icon_id: 114
        id: 7471105
        ip_number: 0
        ip_range_number: 0
        name: Okta-Web
        obsolete: 0
        reputation: 0
        singularity: 0
        sld_id: 0
    register: fw_data

  - name: Display info
    debug:
      msg: "{{ fw_data }}"
      
    - name: Configure devices.
    fortios_firewall_policy:
      vdom:  root
      state: present
      firewall_policy:
        policyid: 27
        srcintf:
          - name: port1
        dstintf:
          - name: port1
        srcaddr:
          - name: all
        dstaddr:
          - name: all
        action: accept
        service:
          - name: ALL
        name: testPolicy
        status: enable
        schedule: always
        logtraffic: all
        logtraffic_start: disable
